{"version":3,"sources":["../index.ts","index.js"],"names":["wm","watermark","init"],"mappings":";AAmKA,aAAA,IAAA,EAAA,MAAA,KAAA,UAAA,WAAA,OAAA,EAAA,OAAA,QAAA,SAAA,GAAA,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,UAAA,OAAA,EAAA,EAAA,IAAA,IAAA,IAAA,KAAA,EAAA,UAAA,GAAA,OAAA,UAAA,eAAA,KAAA,EAAA,KAAA,EAAA,GAAA,EAAA,IAAA,OAAA,IAAA,MAAA,KAAA,YAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IA3GA,IAAA,EAAA,WAIE,SAAA,EAAY,GAYN,GAfE,KAAA,QAAgC,KAChC,KAAA,gBAA0B,EAC1B,KAAA,WAA4B,KAE7B,KAAA,QAAO,EAAA,CACV,GAAI,gBACJ,KAAM,GACN,QAAS,GACT,QAAS,GACT,KAAM,GACN,MAAO,IACP,MAAO,IACP,MAAO,IACJ,GAE+B,IAAhC,SAAS,YAAY,OAAc,CAC/B,IAAA,EAAQ,SAAS,cAAc,SAC5B,SAAA,KAAK,YAAY,GAEvB,KAAA,gBAAkB,SAAS,YAAY,OAAS,EAChD,KAAA,WAAa,SAAS,YACzB,KAAK,iBAmFX,OAhFS,EAAA,UAAA,KAAP,WACO,KAAA,cAAc,iBAEd,EAAA,UAAA,QAAP,WACQ,IAAA,EAAK,SAAS,eAAe,KAAK,QAAQ,IAC3C,IACF,EAAA,UAAY,KAOT,EAAA,UAAA,YAAR,WACU,IAAA,EAAA,KAAA,QAAA,GACJ,EAAU,SAAS,eAAe,GAChC,EAAU,IAAI,EAAE,yQAmBf,OANF,IACE,KAAA,WAAW,WAAW,EAAS,KAAK,kBAC/B,EAAA,SAAS,cAAc,QACzB,aAAa,KAAM,GAClB,SAAA,KAAK,YAAY,IAErB,MAOD,EAAA,UAAA,cAAR,WAEQ,IAAA,EAAY,KAAK,IACrB,SAAS,KAAK,YACd,SAAS,KAAK,aAEV,EAAa,KAAK,IACtB,SAAS,KAAK,aACd,SAAS,KAAK,cAGV,EACJ,KAAK,IAAI,KAAK,QAAQ,OAAS,KAAK,QAAQ,KAC5C,KAAK,IAAI,KAAK,QAAQ,OAAS,KAAK,QAAQ,MAGxC,EACJ,KAAK,KAAK,GAAc,EAAS,EAAI,KAAK,QAAQ,UAClD,KAAK,KAAK,GAAa,KAAK,QAAQ,MAAQ,EAAI,KAAK,QAAQ,UAEzD,EAAM,SAAS,yBAEf,EAAU,IAAI,KAAK,QAAQ,GAAE,sCACZ,KAAK,QAAQ,MAAK,uBAC9B,KAAK,QAAQ,MAAK,sBACjB,KAAK,QAAQ,QAAO,MAAM,KAAK,QAAQ,QAAO,uBAC7C,KAAK,QAAQ,MAAK,UAE1B,KAAA,WAAW,WAAW,EAAS,KAAK,iBAEpC,IAAA,IAAI,EAAI,EAAG,GAAK,EAAO,IAAK,CACzB,IAAA,EAAO,SAAS,cAAc,OAC9B,EAAO,SAAS,eAAe,KAAK,QAAQ,MAC7C,EAAA,YAAY,GACb,EAAA,YAAY,GAET,SAAA,eAAe,KAAK,QAAQ,IAAI,YAAY,IAEzD,EAzGA,GA2GA,QAAA,QAAe;;ACzJf,aAVA,IAAA,EAAA,QAAA,eAUA,EAAA,EAAA,GAAA,SAAA,EAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,GARA,IAAMA,EAAK,IAAIC,EAAJ,QAAc,CACjB,KAAA,cAGRD,EAAGE","file":"example.2dce7bde.map","sourceRoot":"../example","sourcesContent":["/**\n * 生成网站水印\n * @author Eward\n * 18/08/31\n */\nexport type watermarkSettingType = {\n  /**\n   * 包裹dom的id\n   * @author Eward\n   * 18/08/31\n   */\n  id?: string;\n  /**\n   * 水印显示的字\n   * @author Eward\n   * 18/08/31\n   */\n  text: string;\n  /**\n   * 横向之间间距\n   * @author Eward\n   * 18/08/31\n   */\n  gutterX?: number;\n  /**\n   * 纵向之间间距\n   * @author Eward\n   * 18/08/31\n   */\n  gutterY?: number;\n  /**\n   * 字体大小\n   * @author Eward\n   * 18/08/31\n   */\n  size?: number;\n  /**\n   * 透明度(0-1)\n   * @author Eward\n   * 18/08/31\n   */\n  alpha?: number;\n  /**\n   * 单个水印长度\n   * @author Eward\n   * 18/08/31\n   */\n  width?: number;\n  /**\n   * 水印倾斜度数\n   * @author Eward\n   * 18/08/31\n   */\n  angle?: number;\n};\n\nclass Watermark {\n  private setting: watermarkSettingType = null;\n  private styleSheetIndex: number = 0;\n  private styleSheet: CSSStyleSheet = null;\n  constructor(setting: watermarkSettingType) {\n    this.setting = {\n      id: \"watermark-web\",\n      text: \"\",\n      gutterX: 15,\n      gutterY: 15,\n      size: 15,\n      alpha: 0.35,\n      width: 200,\n      angle: 15,\n      ...setting\n    };\n    if (document.styleSheets.length === 0) {\n      const style = document.createElement(\"style\");\n      document.head.appendChild(style);\n    }\n    this.styleSheetIndex = document.styleSheets.length - 1;\n    this.styleSheet = document.styleSheets[\n      this.styleSheetIndex\n    ] as CSSStyleSheet;\n  }\n  public init() {\n    this.gWrapperDOM().gWatermarkDOM();\n  }\n  public destory(): void {\n    const el = document.getElementById(this.setting.id);\n    if (!el) return;\n    el.innerHTML = \"\";\n  }\n  /**\n   * 生成包裹层\n   * @author Eward\n   * 18/08/31\n   */\n  private gWrapperDOM(): this {\n    const { id } = this.setting;\n    let wrapper = document.getElementById(id);\n    const cssRule = `#${id} {\n      pointer-events: none;\n      position: fixed;\n      top: 0;\n      z-index: 9999;\n      width: 100vw;\n      height: 100vh;\n      display: flex;\n      justify-content: space-around;\n      align-content: space-around;\n      flex-wrap: wrap;\n    }`;\n\n    if (!wrapper) {\n      this.styleSheet.insertRule(cssRule, this.styleSheetIndex);\n      wrapper = document.createElement(\"div\");\n      wrapper.setAttribute(\"id\", id);\n      document.body.appendChild(wrapper);\n    }\n    return this;\n  }\n  /**\n   * 循环生成每个水印dom\n   * @author Eward\n   * 18/08/31\n   */\n  private gWatermarkDOM() {\n    // --------- 取出屏幕宽高 --------- created at 18.08.31 -- by Eward\n    const max_width = Math.max(\n      document.body.scrollWidth,\n      document.body.clientWidth\n    );\n    const max_height = Math.max(\n      document.body.scrollHeight,\n      document.body.clientHeight\n    );\n    // --------- 计算出经过旋转后的水印实际高度 --------- created at 18.08.31 -- by Eward\n    const height =\n      Math.cos(this.setting.angle) * this.setting.size +\n      Math.sin(this.setting.angle) * this.setting.width;\n\n    // --------- 计算能生成多少个水印 --------- created at 18.08.31 -- by Eward\n    const total =\n      Math.ceil(max_height / (height + 2 * this.setting.gutterY)) *\n      Math.ceil(max_width / (this.setting.width + 2 * this.setting.gutterX));\n\n    const dom = document.createDocumentFragment();\n\n    const cssRule = `#${this.setting.id} > div {\n      transform: rotate(-${this.setting.angle}deg);\n      width: ${this.setting.width}px;\n      margin: ${this.setting.gutterY}px ${this.setting.gutterX}px;\n      opacity: ${this.setting.alpha}\n    }`;\n    this.styleSheet.insertRule(cssRule, this.styleSheetIndex);\n\n    for (let i = 1; i <= total; i++) {\n      const span = document.createElement(\"div\");\n      const text = document.createTextNode(this.setting.text);\n      span.appendChild(text);\n      dom.appendChild(span);\n    }\n    document.getElementById(this.setting.id).appendChild(dom);\n  }\n}\n\nexport default Watermark;\n","import watermark from \"../index.ts\";\n\nconst wm = new watermark({\n  text: \"ewardwang\"\n});\n\nwm.init();\n\n// setTimeout(() => {\n//   wm.destory()\n// }, 3000);\n"]}